<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width initial-scale=1">
<title>Cici AI WA Bisnis</title>
<script src="https://builds.nekolabs.web.id/code/public-ai.js"></script>

<style>
body{margin:0;padding:0;background:#ece5dd;font-family:Arial;display:flex;justify-content:center}
.wrap{width:100%;max-width:450px;height:100vh;display:flex;flex-direction:column;background:#fff}
.head{background:#075e54;color:white;padding:14px;display:flex;align-items:center;gap:12px}
.pfp{width:42px;height:42px;border-radius:50%;background:url('https://i.imgur.com/Zq0Vq8e.png') center/cover no-repeat}
.title span:first-child{font-size:17px;font-weight:600}
.title span:last-child{font-size:12px;opacity:.9}
.messages{flex:1;overflow-y:auto;padding:16px 12px;background:#e5ddd5;display:flex;flex-direction:column;gap:10px}
.msg{max-width:75%;padding:10px 12px;border-radius:10px;font-size:15px;line-height:1.4;white-space:pre-wrap;position:relative}
.user{align-self:flex-end;background:#dcf8c6}
.user .check{position:absolute;bottom:4px;right:6px;font-size:12px;color:#34b7f1}
.ai{align-self:flex-start;background:white}
.typing{display:inline-flex;gap:3px}
.typing span{width:6px;height:6px;background:#888;border-radius:50%;animation:blink 1s infinite}
.typing span:nth-child(2){animation-delay:.2s}
.typing span:nth-child(3){animation-delay:.4s}
@keyframes blink{0%{opacity:.3}50%{opacity:1}100%{opacity:.3}}
.quick{padding:10px;background:#f5f5f5;border-top:1px solid #ddd;display:flex;gap:6px;overflow-x:auto;white-space:nowrap}
.chip{padding:8px 14px;background:#fff;border-radius:20px;border:1px solid #ddd;cursor:pointer;font-size:14px}
.sendbox{padding:10px;display:flex;gap:8px;background:white;border-top:1px solid #ccc}
textarea{flex:1;padding:10px;border:1px solid #ccc;border-radius:20px;resize:none;height:45px}
button{width:70px;border:none;background:#128c7e;color:white;border-radius:20px;cursor:pointer}
</style>
</head>
<body>
<div class="wrap">
  <div class="head">
    <div class="pfp"></div>
    <div class="title">
      <span>Cici AI Bisnis</span>
      <span>online</span>
    </div>
  </div>

  <div id="messages" class="messages"></div>

  <div class="quick">
    <div class="chip" onclick="quick('Halo apa layanan yang tersedia')">Layanan</div>
    <div class="chip" onclick="quick('Beri saya informasi produk')">Produk</div>
    <div class="chip" onclick="quick('Cara pesan bagaimana')">Cara pesan</div>
    <div class="chip" onclick="quick('Apakah ada promo hari ini')">Promo</div>
  </div>

  <div class="sendbox">
    <textarea id="input" placeholder="Tulis pesan"></textarea>
    <button onclick="sendMsg()">Kirim</button>
  </div>
</div>

<script>
const messages=document.getElementById("messages")

function addMsg(text,type){
  const div=document.createElement("div")
  div.className="msg "+type
  div.textContent=text
  if(type==="user"){
    const ck=document.createElement("span")
    ck.className="check"
    ck.textContent="✓✓"
    div.appendChild(ck)
  }
  messages.appendChild(div)
  messages.scrollTop=messages.scrollHeight
}

function setTyping(){
  const div=document.createElement("div")
  div.className="msg ai"
  div.id="typing"
  const t=document.createElement("div")
  t.className="typing"
  t.innerHTML="<span></span><span></span><span></span>"
  div.appendChild(t)
  messages.appendChild(div)
  messages.scrollTop=messages.scrollHeight
}

function removeTyping(){
  const t=document.getElementById("typing")
  if(t) t.remove()
}

function quick(msg){
  document.getElementById("input").value=msg
  sendMsg()
}

async function sendMsg(){
  const val=document.getElementById("input").value.trim()
  if(!val) return
  addMsg(val,"user")
  document.getElementById("input").value=""
  setTyping()

  try{
    const res=await PublicAI.chat({
      model:"gpt-4-mini",
      messages:[
        {role:"system",content:"Kamu adalah Cici AI WhatsApp Business sopan cepat informatif"},
        {role:"user",content:val}
      ]
    })
    removeTyping()
    addMsg(res.data,"ai")
  }catch(e){
    removeTyping()
    addMsg("Cici gagal merespon","ai")
  }
}
</script>
</body>
</html>
